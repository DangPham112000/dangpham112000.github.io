<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Encryption
  #


  Hash
  #


Can take a message of arbitrary length and transform it into a fixed-length digest
Some of the commonly used hashing algorithms: Bcrypt, MD5, SHA1, SHA256, SHA512, and etc

MD5(&#39;hello&#39;) = 5d41402abc4b2a76b9719d911017c592
Note: An 8-bit byte is represented as 2 characters, from 00 to FF, in hexadecimal

  Good hash function
  #


Fast (exclude Bcrypt)
One-way function
Collision resistance


  Use case
  #


Checking file integrity
Indexing in in-memory databases (Eg: Redis)
Hashing passwords (&#43; salt)
Message authentication code (MAC)
Digital signatures


  Collision
  #

">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://dangpham112000.github.io/docs/research/encryption/">
  <meta property="og:site_name" content="Dante 0401">
  <meta property="og:title" content="Encryption">
  <meta property="og:description" content="Encryption # Hash # Can take a message of arbitrary length and transform it into a fixed-length digest Some of the commonly used hashing algorithms: Bcrypt, MD5, SHA1, SHA256, SHA512, and etc MD5(&#39;hello&#39;) = 5d41402abc4b2a76b9719d911017c592
Note: An 8-bit byte is represented as 2 characters, from 00 to FF, in hexadecimal
Good hash function # Fast (exclude Bcrypt) One-way function Collision resistance Use case # Checking file integrity Indexing in in-memory databases (Eg: Redis) Hashing passwords (&#43; salt) Message authentication code (MAC) Digital signatures Collision #">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2024-11-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-11-15T00:00:00+00:00">
<title>Encryption | Dante 0401</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="canonical" href="https://dangpham112000.github.io/docs/research/encryption/">
<link rel="stylesheet" href="/book.min.ef1786281083252320100bd5f394f36844d3252afdbd5bfe72e5f440aaff402b.css" integrity="sha256-7xeGKBCDJSMgEAvV85TzaETTJSr9vVv&#43;cuX0QKr/QCs=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3bbedb2545ee821d4d23c1a778f94b4cf022bfdb22a925b3c9a83a5ad8b16f50.js" integrity="sha256-O77bJUXugh1NI8GnePlLTPAiv9siqSWzyag6Wtixb1A=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Dante 0401</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>RESEARCH</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/process_vs_thread/" class="">Process vs Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/chrome_architecture/" class="">Chrome Architecture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/aws_overview/" class="">AWS Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/" class="">Backend Protocol</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/tls_ssl/" class="">TLS - SSL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/websocket/" class="">Websocket - Draft</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/be_protocol/communication/" class="">Communication - Draft</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/encryption/" class="active">Encryption</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/token_based_authentication/" class="">Token-based Authentication</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/" class="">Security - Draft</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/hsts/" class="">HSTS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/security/bit_flipping/" class="">Bit Flipping</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/research/scale/" class="">Scale</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>TIPS</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/001_unit_test/" class="">Unit Test</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/002_git/" class="">Git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/003_docker/" class="">Docker</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/004_ops/" class="">Ops</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tips/005_passion/" class="">Spark Passion</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>PROBLEMS</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/problems/knight_dialer/" class="">Knight Dialer</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Encryption</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#hash">Hash</a>
      <ul>
        <li><a href="#good-hash-function">Good hash function</a></li>
        <li><a href="#use-case">Use case</a></li>
        <li><a href="#collision">Collision</a></li>
      </ul>
    </li>
    <li><a href="#symmetric-encryption">Symmetric encryption</a>
      <ul>
        <li><a href="#use-case-1">Use case</a></li>
        <li><a href="#demo-code">Demo code</a></li>
      </ul>
    </li>
    <li><a href="#hmac">HMAC</a>
      <ul>
        <li><a href="#why-and-how">Why and how</a></li>
        <li><a href="#use-case-2">Use case</a></li>
        <li><a href="#demo">Demo</a></li>
      </ul>
    </li>
    <li><a href="#asymmetric-encryption">Asymmetric encryption</a>
      <ul>
        <li><a href="#public-encryption--private-decryption">Public encryption / private decryption</a></li>
        <li><a href="#private-sign-encryption--public-verify-decryption">Private sign (encryption) / public verify (decryption)</a></li>
      </ul>
    </li>
    <li><a href="#key-exchange">Key exchange</a>
      <ul>
        <li><a href="#diffie-hellman">Diffie-Hellman</a></li>
        <li><a href="#elliptic-curve-diffie-hellman-ecdh">Elliptic-curve Diffie-Hellman (ECDH)</a></li>
      </ul>
    </li>
    <li><a href="#digital-signatures">Digital signatures</a>
      <ul>
        <li><a href="#how">How</a></li>
        <li><a href="#use-cases">Use cases</a></li>
        <li><a href="#demo-1">Demo</a></li>
      </ul>
    </li>
    <li><a href="#appendix">Appendix</a>
      <ul>
        <li><a href="#bcrypt-vs-md5">Bcrypt vs MD5</a></li>
        <li><a href="#compare-speed">Compare speed</a></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="encryption">
  Encryption
  <a class="anchor" href="#encryption">#</a>
</h1>
<h2 id="hash">
  Hash
  <a class="anchor" href="#hash">#</a>
</h2>
<ul>
<li>Can take a message of <strong>arbitrary length</strong> and transform it into a <strong>fixed-length</strong> digest</li>
<li>Some of the commonly used hashing algorithms: <strong>Bcrypt</strong>, MD5, SHA1, SHA256, SHA512, and etc</li>
</ul>
<p><code>MD5('hello') = 5d41402abc4b2a76b9719d911017c592</code></p>
<p><em>Note: An 8-bit byte is represented as 2 characters, from 00 to FF, in hexadecimal</em></p>
<h3 id="good-hash-function">
  Good hash function
  <a class="anchor" href="#good-hash-function">#</a>
</h3>
<ul>
<li>Fast (exclude Bcrypt)</li>
<li><strong>One-way function</strong></li>
<li>Collision resistance</li>
</ul>
<h3 id="use-case">
  Use case
  <a class="anchor" href="#use-case">#</a>
</h3>
<ul>
<li>Checking file integrity</li>
<li>Indexing in in-memory databases (Eg: Redis)</li>
<li>Hashing passwords (+ salt)</li>
<li>Message authentication code (MAC)</li>
<li>Digital signatures</li>
</ul>
<h3 id="collision">
  Collision
  <a class="anchor" href="#collision">#</a>
</h3>
<p><img src="/research/encription/hashing_collision.png" alt="hashing_collision" /></p>
<details ><summary><strong>MD5 Collision Demo</strong></summary>
  <div class="markdown-inner">
    <p>d131dd02c5e6eec4693d9a0698aff95c2fcab5<strong>8</strong>712467eab4004583eb8fb7f89
55ad340609f4b30283e4888325<strong>7</strong>1415a085125e8f7cdc99fd91dbd<strong>f</strong>280373c5b
d8823e3156348f5bae6dacd436c919c6dd53e2<strong>b</strong>487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080<strong>a</strong>80d1ec69821bcb6a8839396f965<strong>2</strong>b6ff72a70</p>
<p>VS</p>
<p>d131dd02c5e6eec4693d9a0698aff95c2fcab5<strong>0</strong>712467eab4004583eb8fb7f89
55ad340609f4b30283e4888325<strong>f</strong>1415a085125e8f7cdc99fd91dbd<strong>7</strong>280373c5b
d8823e3156348f5bae6dacd436c919c6dd53e2<strong>3</strong>487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080<strong>2</strong>80d1ec69821bcb6a8839396f965<strong>a</strong>b6ff72a70</p>
<p><strong>NodeJS</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Input 1 (Hexadecimal)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">input1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;d131dd02c5e6eec4693d9a0698aff95c2fcab58712467eab4004583eb8fb7f89&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;55ad340609f4b30283e488832571415a085125e8f7cdc99fd91dbdf280373c5b&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;d8823e3156348f5bae6dacd436c919c6dd53e2b487da03fd02396306d248cda0&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;e99f33420f577ee8ce54b67080a80d1ec69821bcb6a8839396f9652b6ff72a70&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;hex&#39;</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Input 2 (Hexadecimal)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">input2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;d131dd02c5e6eec4693d9a0698aff95c2fcab50712467eab4004583eb8fb7f89&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;55ad340609f4b30283e4888325f1415a085125e8f7cdc99fd91dbd7280373c5b&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;d8823e3156348f5bae6dacd436c919c6dd53e23487da03fd02396306d248cda0&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;e99f33420f577ee8ce54b67080280d1ec69821bcb6a8839396f965ab6ff72a70&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;hex&#39;</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Function to calculate MD5 hash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateMD5</span>(<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createHash</span>(<span style="color:#e6db74">&#39;md5&#39;</span>).<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">digest</span>(<span style="color:#e6db74">&#39;hex&#39;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Are the inputs identical?&#39;</span>, <span style="color:#a6e22e">input1</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">input2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hash1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">calculateMD5</span>(<span style="color:#a6e22e">input1</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hash2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">calculateMD5</span>(<span style="color:#a6e22e">input2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;MD5 Hash of Input 1:&#39;</span>, <span style="color:#a6e22e">hash1</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;MD5 Hash of Input 2:&#39;</span>, <span style="color:#a6e22e">hash2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Are the hashes identical?&#39;</span>, <span style="color:#a6e22e">hash1</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">hash2</span>);
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Are the inputs identical? false
</span></span><span style="display:flex;"><span>MD5 Hash of Input 1: 79054025255fb1a26e4bc422aef54eb4
</span></span><span style="display:flex;"><span>MD5 Hash of Input 2: 79054025255fb1a26e4bc422aef54eb4
</span></span><span style="display:flex;"><span>Are the hashes identical? true
</span></span></code></pre></div>
  </div>
</details>

<h2 id="symmetric-encryption">
  Symmetric encryption
  <a class="anchor" href="#symmetric-encryption">#</a>
</h2>
<p>Uses the same key to encrypt and decrypt messages</p>
<p>AES, Twofish and ChaCha20</p>
<p><img src="/research/encription/Symmetric.png" alt="Symmetric" /></p>
<h3 id="use-case-1">
  Use case
  <a class="anchor" href="#use-case-1">#</a>
</h3>
<ul>
<li>HTTP over SSL/TLS: Session key</li>
<li>Data Transmission</li>
<li>Data Storage</li>
</ul>
<h3 id="demo-code">
  Demo code
  <a class="anchor" href="#demo-code">#</a>
</h3>
<p>This example demonstrates symmetric encryption and decryption  using the crypto module with AES (Advanced Encryption Standard) in AES-256-CBC mode</p>
<p><strong>NodeJS</strong></p>
<details ><summary>Init necessary functions</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">generateKeyAndIv</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">randomBytes</span>(<span style="color:#ae81ff">32</span>).<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>); <span style="color:#75715e">// 256-bit key as hex string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">randomBytes</span>(<span style="color:#ae81ff">16</span>).<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>); <span style="color:#75715e">// 128-bit IV as hex string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">keyHex</span>, <span style="color:#a6e22e">ivHex</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">keyHex</span>, <span style="color:#e6db74">&#39;hex&#39;</span>); <span style="color:#75715e">// Convert key from hex to Buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">ivHex</span>, <span style="color:#e6db74">&#39;hex&#39;</span>);   <span style="color:#75715e">// Convert iv from hex to Buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cipher</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createCipheriv</span>(<span style="color:#e6db74">&#39;aes-256-cbc&#39;</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cipher</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">text</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>, <span style="color:#e6db74">&#39;hex&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">cipher</span>.<span style="color:#66d9ef">final</span>(<span style="color:#e6db74">&#39;hex&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">encrypted</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">encryptedText</span>, <span style="color:#a6e22e">keyHex</span>, <span style="color:#a6e22e">ivHex</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">keyHex</span>, <span style="color:#e6db74">&#39;hex&#39;</span>); <span style="color:#75715e">// Convert key from hex to Buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">ivHex</span>, <span style="color:#e6db74">&#39;hex&#39;</span>);   <span style="color:#75715e">// Convert iv from hex to Buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decipher</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createDecipheriv</span>(<span style="color:#e6db74">&#39;aes-256-cbc&#39;</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decipher</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">encryptedText</span>, <span style="color:#e6db74">&#39;hex&#39;</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">decipher</span>.<span style="color:#66d9ef">final</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Encrypt and decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIv</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Generated Key (hex):&#34;</span>, <span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Generated IV (hex):&#34;</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, this is a secret message!&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">encryptedMessage</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Generated Key (hex): 00298bfc28cf81a3de3502951b70f3568c4dd5dadbcfadd7b79fee2e640aee07
</span></span><span style="display:flex;"><span>Generated IV (hex): 387591abb794b2345f496bb1192ace36
</span></span><span style="display:flex;"><span>Original Message: Hello, this is a secret message!
</span></span><span style="display:flex;"><span>Encrypted Message: 96b91c46b8e380a3b3fc9caf473821508f1ec313ed8b4306eb839c9c04f3692ed0579485016559e272ba9c3c54c5c449
</span></span><span style="display:flex;"><span>Decrypted Message: Hello, this is a secret message!
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Decrypt a message with wrong key</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIv</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Generated Key (hex):&#34;</span>, <span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Generated IV (hex):&#34;</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">key</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">key2</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIv</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Generated Key 2 (hex):&#34;</span>, <span style="color:#a6e22e">key2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, this is a secret message!&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">encryptedMessage</span>, <span style="color:#a6e22e">key2</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Generated Key (hex): 0e35a011a116b0708012ae4165b95be678300be387478c1f217dbc48a1e5f2e8
</span></span><span style="display:flex;"><span>Generated IV (hex): 6b714efdcab58ebc399332b79df8354d
</span></span><span style="display:flex;"><span>Generated Key 2 (hex): c5bd73c9fa521dd1b019b3be1010645fc2152db17401006781a3908db43ca94f
</span></span><span style="display:flex;"><span>Original Message: Hello, this is a secret message!
</span></span><span style="display:flex;"><span>Encrypted Message: a4b90407ab748d8002d2f33b6ae8698460ed11d1640592fb2e83da9f101e7795ba54e447162f5373f49592ebfff8fa5c
</span></span><span style="display:flex;"><span>node:internal/crypto/cipher:199
</span></span><span style="display:flex;"><span>  const ret = this[kHandle].final();
</span></span><span style="display:flex;"><span>                            ^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: error:1C800064:Provider routines::bad decrypt
</span></span><span style="display:flex;"><span>    at Decipheriv.final (node:internal/crypto/cipher:199:29)
</span></span><span style="display:flex;"><span>    at decrypt (/home/dangpham/Workspace/nodejs/demo/symmetric.js:23:27)
</span></span><span style="display:flex;"><span>    at Object.&lt;anonymous&gt; (/home/dangpham/Workspace/nodejs/demo/symmetric.js:55:26)
</span></span><span style="display:flex;"><span>    at Module._compile (node:internal/modules/cjs/loader:1356:14)
</span></span><span style="display:flex;"><span>    at Module._extensions..js (node:internal/modules/cjs/loader:1414:10)
</span></span><span style="display:flex;"><span>    at Module.load (node:internal/modules/cjs/loader:1197:32)
</span></span><span style="display:flex;"><span>    at Module._load (node:internal/modules/cjs/loader:1013:12)
</span></span><span style="display:flex;"><span>    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
</span></span><span style="display:flex;"><span>    at node:internal/main/run_main_module:28:49 {
</span></span><span style="display:flex;"><span>  library: &#39;Provider routines&#39;,
</span></span><span style="display:flex;"><span>  reason: &#39;bad decrypt&#39;,
</span></span><span style="display:flex;"><span>  code: &#39;ERR_OSSL_BAD_DECRYPT&#39;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Node.js v18.19.1
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Decrypt a message with wrong iv</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIv</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">iv</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iv2</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIv</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">encryptedMessage</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv2</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Generated Key (hex): 76e1a03f6b3e326cd8c383ce12ff6fbd4b77c484afa7811f93304bc548b9de01
</span></span><span style="display:flex;"><span>Generated IV (hex): 11edd0224d639ac9d8b1c0a1297ed758
</span></span><span style="display:flex;"><span>Generated IV2 (hex): aca3f6cd3738dab6c97c43a211ec121f
</span></span><span style="display:flex;"><span>Original Message: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</span></span><span style="display:flex;"><span>Encrypted Message: 3189b2b3fbb3d511086609f2cbb5f68928fd980bad454fbcfba3c7aada3f6499832a19be0b6285f3b6ed175d67b4fb04c76c4443873a7f6eecbbf3a667dfc70146916de1f55d5e6d057bbed520e9489b97ce25d1cae41a58db5fe3adcf59d6f0d668a4b9561f32303544b90aa5a800000fe2f30f611e9b23af7170e9f95abecd2023df028570e8816a02c603883a90b1b722f2139b3588e78f4dad472f1e799875e30e8a54f9ae9a761779963abd83cc9a8138a91f57b66a9c499a0e0ae0d57ee409bd381d15c52fdeee4b96684cc35bf2db78dedfa433db25fd1323c887597693571d9dab1c1b052a9ed74195aae89a6db5ef47bed08aae24100b19e7ca3e64389fa8b99ad89104f50a7aa291731985e0b464213df61e50df2df5b22b21767987e5b40c5def1ae6ce80a34845d13ca06a6fe250ef291a4ef01b01b531c843d0201b8b06d41b727e0799dd6742a5814a76fefc57a0ba1f7badc854702e8c6f2f88c13d320c45c300a007464c64e73919403e21527570dec2afbb21746fded82a4360887ff7aad565a797cc731deb6cf6f23dccb73427b21c061f46939d1d5e6ef7b16079467199a9ce03f558dbcb3141f2502683cb5af69ec47e35f343bb5e25
</span></span><span style="display:flex;"><span>Decrypted Message: �!T�{)b��#\��(r sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</span></span></code></pre></div>
  </div>
</details>

<h2 id="hmac">
  HMAC
  <a class="anchor" href="#hmac">#</a>
</h2>
<ul>
<li>HMAC stands for Hash-based Message Authentication Code</li>
<li>It&rsquo;s a method that generates a <strong>Message Authentication Code</strong> (MAC)</li>
<li>The major <strong>difference</strong> between a <strong>hash</strong> and an <strong>HMAC</strong> is that HMAC uses a <strong>secret key</strong></li>
<li>It&rsquo;s used to prove message authenticity and <strong>integrity</strong></li>
<li>There exist many algorithms for calculating a MAC, such as SipHash, BLAKE2, CMAC, etc</li>
</ul>
<p><img src="/research/encription/hmac.png" alt="hmac" /></p>
<h3 id="why-and-how">
  Why and how
  <a class="anchor" href="#why-and-how">#</a>
</h3>
<ul>
<li>See more details about the bit-flipping attack <a href="/docs/research/security/bit_flipping">here</a></li>
</ul>
<p><img src="/research/security/bit_flipping/bit_flipping.png" alt="bit_flipping" /></p>
<ul>
<li>Here shows you how HMAC prevents a bit-flipping attack</li>
</ul>
<p><img src="/research/encription/hmac_flow.png" alt="hmac_flow" /></p>
<h3 id="use-case-2">
  Use case
  <a class="anchor" href="#use-case-2">#</a>
</h3>
<ul>
<li>Signing <strong>JSON Web Tokens</strong> (JWTs) for secure authentication</li>
<li>Signing files in <strong>secure file transfer protocols</strong>. Eg: SSH File Transfer Protocol (SFTP), FTP over SSL (FTPS)</li>
<li>Verifying the integrity and authenticity of transactions in banking</li>
</ul>
<h3 id="demo">
  Demo
  <a class="anchor" href="#demo">#</a>
</h3>
<p>This example demonstrates how HMAC prevents bit-flipping attack</p>
<blockquote class="book-hint info">
  This demo can be run directly in the console of the Chrome browser
</blockquote>

<p><strong>Javascript</strong></p>
<details ><summary>Prepare</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">getRandomValues</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#ae81ff">16</span>));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">key</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">generateKey</span>(
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AES-CBC&#34;</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">length</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">128</span>,
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>		[<span style="color:#e6db74">&#34;encrypt&#34;</span>, <span style="color:#e6db74">&#34;decrypt&#34;</span>]
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>})();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encryptData</span>(<span style="color:#a6e22e">plaintext</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encoder</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextEncoder</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encoder</span>.<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">plaintext</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ciphertext</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">encrypt</span>(
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AES-CBC&#34;</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">iv</span>,
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">key</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">data</span>
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">ciphertext</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptData</span>(<span style="color:#a6e22e">ciphertext</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">plaintextBuffer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">decrypt</span>(
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AES-CBC&#34;</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">iv</span>,
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">key</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ciphertext</span>
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decoder</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextDecoder</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decoder</span>.<span style="color:#a6e22e">decode</span>(<span style="color:#a6e22e">plaintextBuffer</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deriveHmacKey</span>(<span style="color:#a6e22e">aesKey</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rawKey</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">exportKey</span>(<span style="color:#e6db74">&#34;raw&#34;</span>, <span style="color:#a6e22e">aesKey</span>); 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">importKey</span>(
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;raw&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">rawKey</span>,
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HMAC&#34;</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">hash</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SHA-1&#34;</span> }, 
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>		[<span style="color:#e6db74">&#34;sign&#34;</span>, <span style="color:#e6db74">&#34;verify&#34;</span>]
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">signData</span>(<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encoder</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextEncoder</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encodedData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encoder</span>.<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hmacKey</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">deriveHmacKey</span>(<span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signature</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">sign</span>(<span style="color:#e6db74">&#34;HMAC&#34;</span>, <span style="color:#a6e22e">hmacKey</span>, <span style="color:#a6e22e">encodedData</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">signature</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">verifyData</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">signature</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encoder</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextEncoder</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encodedData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encoder</span>.<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hmacKey</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">deriveHmacKey</span>(<span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isValid</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">verify</span>(
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;HMAC&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">hmacKey</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">signature</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">encodedData</span>
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">isValid</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ord</span>(<span style="color:#a6e22e">string</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">string</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Main flow</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>(<span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// User
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">plaintext</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{ Message: &#39;Doing  charity  work!&#39;, Money: 001 $, To: Beggar }&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ciphertext</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">encryptData</span>(<span style="color:#a6e22e">plaintext</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signature</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">signData</span>(<span style="color:#a6e22e">ciphertext</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Hacker
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">43</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;0&#34;</span>) <span style="color:#f92672">^</span> <span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">43</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">^</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;9&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">44</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;0&#34;</span>) <span style="color:#f92672">^</span> <span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">44</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">^</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;9&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">45</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;1&#34;</span>) <span style="color:#f92672">^</span> <span style="color:#a6e22e">ciphertext</span>[<span style="color:#ae81ff">45</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>] <span style="color:#f92672">^</span> <span style="color:#a6e22e">ord</span>(<span style="color:#e6db74">&#34;9&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Bank
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedText</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">decryptData</span>(<span style="color:#a6e22e">ciphertext</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Text:&#34;</span>, <span style="color:#a6e22e">decryptedText</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isVerified</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">verifyData</span>(<span style="color:#a6e22e">ciphertext</span>, <span style="color:#a6e22e">signature</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Signature valid:&#34;</span>, <span style="color:#a6e22e">isVerified</span>);
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Output</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&gt; Decrypted Text: { Message: &#39;Doin��iQ���&#39;BT_�&#34;!&#39;, Money: 999 $, To: Beggar }
</span></span><span style="display:flex;"><span>&gt; Signature valid: false
</span></span></code></pre></div>
  </div>
</details>

<h2 id="asymmetric-encryption">
  Asymmetric encryption
  <a class="anchor" href="#asymmetric-encryption">#</a>
</h2>
<ul>
<li>There are generally three things asymmetric algorithms can do:
<ul>
<li><strong>Encrypt/decrypt</strong>: RSA, EC ElGamal</li>
<li><strong>Sign/verify</strong>: RSA, DSA, ECDSA</li>
<li><strong>Key exchange</strong>: Diffie-Hellman, ECDH</li>
</ul>
</li>
<li>The <strong>amount of data</strong> that can be encrypted <strong>depends on</strong> the <strong>modulus length</strong> and the <strong>type</strong> (e.g., RSA 2048-bit modulus length with PKCS#1 can encrypt a maximum of (<code>(&lt;modulus length&gt; / 8) - 42</code> = <strong>2048</strong> / 8) - 42 = 214 bytes)</li>
</ul>
<p><img src="/research/encription/Asymmetric.png" alt="Asymmetric" /></p>
<h3 id="public-encryption--private-decryption">
  Public encryption / private decryption
  <a class="anchor" href="#public-encryption--private-decryption">#</a>
</h3>
<ul>
<li>Algorithms: RSA, EC ElGamal</li>
<li>Common usage</li>
<li>Use cases: <a href="/docs/research/be_protocol/tls_ssl/#tls-12">Key exchange in SSL/TLS 1.2</a></li>
</ul>
<p><strong>NodeJS</strong></p>
<details ><summary>Init necessary functions</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">generateKeyPair</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">generateKeyPairSync</span>(<span style="color:#e6db74">&#39;rsa&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">modulusLength</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2048</span>, <span style="color:#75715e">// Length of key in bits (2048 is standard)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">publicKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Public Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">privateKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Private Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encryptWithPublicKey</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">publicEncrypt</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">encrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;base64&#39;</span>);  <span style="color:#75715e">// Convert encrypted message to base64 for readability
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptWithPrivateKey</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">privateDecrypt</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">encryptedMessage</span>, <span style="color:#e6db74">&#39;base64&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>);  <span style="color:#75715e">// Convert decrypted message to utf8 string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Public key to encrypt and private key to decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Public Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, this is a secret message!&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encryptWithPublicKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decryptWithPrivateKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Public Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>MIIBCgKCAQEA0ivCBvmxFewdtUePX8RG3+SKifuEz9dsoSEJzQiCbdOfxCzZiyCb
</span></span><span style="display:flex;"><span>R7azQhY67IKC93qr/j7zyCGx3WJ2lrRd4ij51Q9CIn75zPExEfLMvCt0HQtO+UQo
</span></span><span style="display:flex;"><span>w0QZLGIZc6Q+eJfQg++PeUVYpZPT/jp3RXHEScpZJfHCarhl6JfCkuu3YuITSpta
</span></span><span style="display:flex;"><span>rhUuaw6UMoWnZCbr0/OW2rC3s97p+VIr5i3jCf+z84E7dTZ529mZ1PsxNue5NKqO
</span></span><span style="display:flex;"><span>/SWyjrNvwORMkdYweoSqz5oZ0U2B29mUWRkhcOrPmrRBCxMRwWTmQC3PpzrAwG2/
</span></span><span style="display:flex;"><span>eQfbKX1tzzSVjjjMUgKvmeLvr57au62yLwIDAQAB
</span></span><span style="display:flex;"><span>-----END RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEowIBAAKCAQEA0ivCBvmxFewdtUePX8RG3+SKifuEz9dsoSEJzQiCbdOfxCzZ
</span></span><span style="display:flex;"><span>iyCbR7azQhY67IKC93qr/j7zyCGx3WJ2lrRd4ij51Q9CIn75zPExEfLMvCt0HQtO
</span></span><span style="display:flex;"><span>+UQow0QZLGIZc6Q+eJfQg++PeUVYpZPT/jp3RXHEScpZJfHCarhl6JfCkuu3YuIT
</span></span><span style="display:flex;"><span>SptarhUuaw6UMoWnZCbr0/OW2rC3s97p+VIr5i3jCf+z84E7dTZ529mZ1PsxNue5
</span></span><span style="display:flex;"><span>NKqO/SWyjrNvwORMkdYweoSqz5oZ0U2B29mUWRkhcOrPmrRBCxMRwWTmQC3PpzrA
</span></span><span style="display:flex;"><span>wG2/eQfbKX1tzzSVjjjMUgKvmeLvr57au62yLwIDAQABAoIBAELNKr4p1gn4QxcP
</span></span><span style="display:flex;"><span>+DfBvJ9EVm52Fegz+jCavjE/r6k11vW1Ja4tfn2ESiTKyQ7MitEbWhiVLMojP5P0
</span></span><span style="display:flex;"><span>zGmpSZ/tUz9Pur8ZKc/kp6qjSETU8PKcWg0rh2NNPU0Ynytc/Ig7BMkytyEeFAeI
</span></span><span style="display:flex;"><span>3ZxUO/3EI9YqbTx8w8VE+As+VVd55dkkoEShi77ibxFNeevWvS46k/d1a5hcsVj8
</span></span><span style="display:flex;"><span>NlsngHux8ZwUu8ZaIQH0wclLo77TcDOJF9NkJb7x8xzXH/pvNOPu49nA098zob6c
</span></span><span style="display:flex;"><span>ivZTW6z2Jsa94NzPzvCQ/NLumrkt07bE0HBXJCkaajlhjn69gXR2fEfWVrryW3e9
</span></span><span style="display:flex;"><span>sLFEPJUCgYEA9hz4qFpM/QB4q1AzNR7ZK5vfzfAIAQWPmbVpFZXYdUD+tzXut7Yu
</span></span><span style="display:flex;"><span>dd4WZU1l/LgUeLUmUfJqDwiMOz/pGSTNcJqtHl3wP2Yz9n1fcWhxdbjbPZkB1+Di
</span></span><span style="display:flex;"><span>dhKkxvxEih4PyK+367udHcJYF+Su7Pl2hNmBMvTc0rzWpdJHRVCrwEMCgYEA2p0o
</span></span><span style="display:flex;"><span>Dyy5dBhrMCi083074qQhdXQqX1+f0KDZXy1u8JtooktbpARfyc+P9/hT+sdvxln7
</span></span><span style="display:flex;"><span>hEsYPkplvPS3ahm0tb4tCW1esAZLhn8RvYJqJConBawKRw2oVJ9YCW1Et4vn+oKU
</span></span><span style="display:flex;"><span>pLfvmgX/PgCIuVn6szmU4LUj9pHoaoE5E0ulLaUCgYEA5n+dtvbTsgR1/2RegTrC
</span></span><span style="display:flex;"><span>BGC5TAOpS2Os6TWJFKlBkBduN6KwT6i1fLiiWwARK44vxhlKqWcTQ78qrvcdVeos
</span></span><span style="display:flex;"><span>6nBDAPTT5FzQ/+LNt8YstSeLVfZuToQVNKYjYyWy/3RGLhu8cnBFJzD0FnScC99b
</span></span><span style="display:flex;"><span>y/J1WYcRJeGsWqNFErsKEEcCgYAw/e0/UVeSU/KZjVXYB2XHSd8RsmHYk9Z9674r
</span></span><span style="display:flex;"><span>HURyeXF+hYLZA/3vfSuXd7hiSBWdjwbVw/p/4y5fpTwBdBdSb3cqWK9SpWaBkrKI
</span></span><span style="display:flex;"><span>FNTym9u44rA+8imaJUeWfT1cIOdw9ZiYPXxduSBVZcs+NpL/XVUm8pFHrbU3QRRo
</span></span><span style="display:flex;"><span>ZZhz3QKBgHcVAZq3TaigmrupfdGlSDN+NdxP7EhOlGaYu5LuJcfic2q/W1+SKoQK
</span></span><span style="display:flex;"><span>5osEUzV/SeWQH5oHW/2ASx2GOwyiWcn2RfXRFPSXfX4aHfO3JBOZVJ8Wzql9WhST
</span></span><span style="display:flex;"><span>NEw2BFi05XXkbE/ncxq5+SZsHVGQVZ0hlkG2oPc3Hp7sDAMJSDQC
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: Hello, this is a secret message!
</span></span><span style="display:flex;"><span>Encrypted Message: Vb+Oc8Kn76rvjJuXZOvtLGsQDm/VGXzB2KbqzWXr5UMZV4bXLkhCs407H4Li4ImROH6uPXlA+SNPSYr0XpLQ+Uksnt2b8YbUQZUSvi15bJbXKKXsvo9FLg2ygcSUiqBjGs3coMbWh0sZnGN+GpXbIld8ItGCkLRnMDkvCK/uzgA11bmLcBOFt726ytjK0qGJGDM1svL2A2ZTXGgnLMUSnSzNxWv5K4sUU0yi38/ineL1Kc6FLlUo3YrLnW6MvB0rp+lF9VRGw8Sbagpm01PcnQiQH28OmbQxLomScQ4Mq1EXqN7oVgE2kMDXIO0mec6I0TmLtsLjWirN0iT2Um/cDQ==
</span></span><span style="display:flex;"><span>Decrypted Message: Hello, this is a secret message!
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Private key to encrypt and decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, this is a secret message!&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encryptWithPublicKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decryptWithPrivateKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEpAIBAAKCAQEA8+Vsp8r+fNSpHdr+cr8+8tX+Tmm/1oCtU4dlVSz+auKLj490
</span></span><span style="display:flex;"><span>duuh+rZ2ud7zgMzzCd9cSqFs4JWHsAFbx2oe4LSWD++V7ZES3ORE+48ksziCMC/r
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>EZUgvYiHTgt3lJnQunBQPGug59B4mB8JRPZIdrpZc8acTA0X5+Ys8PRSwFoNzQ+b
</span></span><span style="display:flex;"><span>pDxXQo6e+j9SU9xi9ULFuK9ZZp48ERgX8MqG+1fdxGU+LFHfK192Kw==
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: Hello, this is a secret message!
</span></span><span style="display:flex;"><span>Encrypted Message: V3fyDYvqx5OzPBJfKO434XKTUSC+c7KnpsvjpSdkUYR+BfrK0A+4V+y1Mf7uuCWaCRIA4Npu9aRoAgDPV8u7Zwc7h6sGaGo8WSofWsADCobDiN1d1dX0Htxurr9tVNmcdvXBxigyLK93h+Q7xXg5Xn2RdBpItPBHDITxfBlCRdyDZX+x81b1xTCdue6mTQwEp8CkJpZsahEPYgW7tYA+rWBu147Cz0jKEstk62Udxc82WYMRT+za0pz2nqSVqDKZCpaXBT1xlmPNgy14bzuLNZbykyUScly3PJUmybi9Ml/+OYjPwLY+XuYbXDklV2OX2fPsiuTo0iwXOwZB7HRE1Q==
</span></span><span style="display:flex;"><span>Decrypted Message: Hello, this is a secret message!
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Private key to encrypt and public key to decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Public Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, this is a secret message!&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encryptWithPublicKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message:&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decryptWithPrivateKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Public Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>MIIBCgKCAQEA2UVnWwcABrWqMggU7xxkl25zzV3/FabJvFDiGtaWjTUhLu9QjKtO
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>wUXBn7HZjrd8Oue5JVPL1KqpUABxLBYc1QIDAQAB
</span></span><span style="display:flex;"><span>-----END RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEpAIBAAKCAQEA2UVnWwcABrWqMggU7xxkl25zzV3/FabJvFDiGtaWjTUhLu9Q
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>lXDeVDYNZZ5oYCOWxjoAYamUbPrXD+SDGsDwnlgcaHViBBxUeGElHw==
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: Hello, this is a secret message!
</span></span><span style="display:flex;"><span>Encrypted Message: VwgGUHIcxGAO5J5THYzxEgrmGQlIWy8Xg8f+c2zuyWjEzlgkat2TIyJa4fZ/vvf/kmIaetfw2cJf7wSvDfHP+yikVYRN2/uQ67pE6dK+FtW0d5GK6HaoM4c6QP/DbeMbikywSFjxYiyKsqp7eREtv8rdEgpde7OVL3pthSZmoJWUoSFNUvMqJT5+D1hPv8J38TlNdEUp7YrIQdx/gyZx8w6q+uikyboJbEJ2Z4YCfJVUbw1Fwbijox/jb8bWRFO6OHb2XXC4w2LXGLoZdxAAykRQ19BTsV6ojMflb1Bw428Q2GNaiolJXZX7j20rVRjM0KccLvHQ5FLPzTmK3BHQxg==
</span></span><span style="display:flex;"><span>node:internal/crypto/cipher:80
</span></span><span style="display:flex;"><span>    return method(data, format, type, passphrase, buffer, padding, oaepHash,
</span></span><span style="display:flex;"><span>           ^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: error:020000B3:rsa routines::missing private key
</span></span><span style="display:flex;"><span>    at Object.privateDecrypt (node:internal/crypto/cipher:80:12)
</span></span><span style="display:flex;"><span>    at decryptWithPrivateKey (/home/dangpham/Workspace/nodejs/demo/asymmetric.js:23:30)
</span></span><span style="display:flex;"><span>    at Object.&lt;anonymous&gt; (/home/dangpham/Workspace/nodejs/demo/asymmetric.js:66:26)
</span></span><span style="display:flex;"><span>    at Module._compile (node:internal/modules/cjs/loader:1356:14)
</span></span><span style="display:flex;"><span>    at Module._extensions..js (node:internal/modules/cjs/loader:1414:10)
</span></span><span style="display:flex;"><span>    at Module.load (node:internal/modules/cjs/loader:1197:32)
</span></span><span style="display:flex;"><span>    at Module._load (node:internal/modules/cjs/loader:1013:12)
</span></span><span style="display:flex;"><span>    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
</span></span><span style="display:flex;"><span>    at node:internal/main/run_main_module:28:49 {
</span></span><span style="display:flex;"><span>  opensslErrorStack: [ &#39;error:1C8000A2:Provider routines::failed to decrypt&#39; ],
</span></span><span style="display:flex;"><span>  library: &#39;rsa routines&#39;,
</span></span><span style="display:flex;"><span>  reason: &#39;missing private key&#39;,
</span></span><span style="display:flex;"><span>  code: &#39;ERR_OSSL_RSA_MISSING_PRIVATE_KEY&#39;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Node.js v18.19.1
</span></span></code></pre></div>
  </div>
</details>

<h3 id="private-sign-encryption--public-verify-decryption">
  Private sign (encryption) / public verify (decryption)
  <a class="anchor" href="#private-sign-encryption--public-verify-decryption">#</a>
</h3>
<ul>
<li>Algorithms: RSA, DSA, ECDSA</li>
<li>Use cases: <a href="/docs/research/token_based_authentication">Token-based authentication</a>, <a href="#digital-signatures">digital signatures</a></li>
</ul>
<p><strong>NodeJS</strong></p>
<details ><summary>Init necessary functions</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">generateKeyPair</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">generateKeyPairSync</span>(<span style="color:#e6db74">&#39;rsa&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">modulusLength</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2048</span>, <span style="color:#75715e">// Length of key in bits (2048 is standard)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">publicKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Public Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">privateKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Private Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Function to &#34;sign&#34; (encrypt) a message using RSA private key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">privateEncrypt</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">encrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;base64&#39;</span>);  <span style="color:#75715e">// Convert encrypted message to base64 for readability
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Function to &#34;verify&#34; (decrypt) a message using RSA public key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">publicDecrypt</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">encryptedMessage</span>, <span style="color:#e6db74">&#39;base64&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>);  <span style="color:#75715e">// Convert decrypted message to utf8 string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Private key to encrypt and public key to decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Public Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;J5 love ST&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// &#34;Sign&#34; the message using the private key (Encrypt)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message (Base64):&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// &#34;Verify&#34; the message using the public key (Decrypt)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Public Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>MIIBCgKCAQEAnxkXw9Cbi4F+tsJImVUNVhOUTYWj/lMUB+jcXBE6myqgZ4xiHWWx
</span></span><span style="display:flex;"><span>0nGzjqxHiojYcN3jiEtABqbls2KToTs9LvNHDYcr8bPh828HZTcB6V9r1x79zFSp
</span></span><span style="display:flex;"><span>jJtvx4hmOa0K7iOiN2AwWaV1mtFTKOZ/2QsQMqyhleBgPMCQyD6CYS2IJrRq6Wu+
</span></span><span style="display:flex;"><span>anekIYgfWToajrpbgs4AE5X0aTd10/0eR0A7n3C8jGKiyAaTsROBtqvmoq69QGrW
</span></span><span style="display:flex;"><span>ozDOWl/Dt6I3Y/a0Vx6lyL2bjClbIo61yJqkxW0VWFLodFuKvjd8gln3PZokTiEl
</span></span><span style="display:flex;"><span>fjQFKVj63Wh/ssXHQjFtYvnmS73gMATYSwIDAQAB
</span></span><span style="display:flex;"><span>-----END RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEowIBAAKCAQEAnxkXw9Cbi4F+tsJImVUNVhOUTYWj/lMUB+jcXBE6myqgZ4xi
</span></span><span style="display:flex;"><span>HWWx0nGzjqxHiojYcN3jiEtABqbls2KToTs9LvNHDYcr8bPh828HZTcB6V9r1x79
</span></span><span style="display:flex;"><span>zFSpjJtvx4hmOa0K7iOiN2AwWaV1mtFTKOZ/2QsQMqyhleBgPMCQyD6CYS2IJrRq
</span></span><span style="display:flex;"><span>6Wu+anekIYgfWToajrpbgs4AE5X0aTd10/0eR0A7n3C8jGKiyAaTsROBtqvmoq69
</span></span><span style="display:flex;"><span>QGrWozDOWl/Dt6I3Y/a0Vx6lyL2bjClbIo61yJqkxW0VWFLodFuKvjd8gln3PZok
</span></span><span style="display:flex;"><span>TiElfjQFKVj63Wh/ssXHQjFtYvnmS73gMATYSwIDAQABAoIBADBGznnKPrC92iP9
</span></span><span style="display:flex;"><span>30a70sCoT0uYvlMJhZ4C0H8VcUmtTSAuroUKG0Pm4Zvs9gZ5EOhqxETSxLpgAXqF
</span></span><span style="display:flex;"><span>8pMtpRqukoRt3G1K7sjOC5nwb6GPpWsRCeVrWUmDzw7melKNCjCJ2orgIrvJI98X
</span></span><span style="display:flex;"><span>HpteGjRTkZY24Q9YFwvISQaiRTDURBuTN1xmKNJ22AFU9oinLbedg0wPJ3xS5YPP
</span></span><span style="display:flex;"><span>nROv8Gz/buoRrxysObguPgaBcOPQB3qz1qdsXwjnCDfQGKzo8LrFGtD1z3Zu4jWx
</span></span><span style="display:flex;"><span>CfxzGisk45FuE0FWksNMwD0mKXDh11unA3p/xCstbwD2ISIiFhSvG09tGYl5pqlD
</span></span><span style="display:flex;"><span>tGOZj2UCgYEA0OAyKRCNKPRxj1nXFtg7eR02YXxlnIqhl1ggXdW6hpwTx1t+Bu28
</span></span><span style="display:flex;"><span>Qi5OsDOBivkTHjqt3x5DQTQTaOdpfwDBUpuYM4NIxL6EoFZaC2R26ocaIsZ4qKkk
</span></span><span style="display:flex;"><span>SmBJW1Yx5iRWrurKB+1iwVshcjAHFyYWiltM4iL25RKAAeE7M1inlGcCgYEAwv3w
</span></span><span style="display:flex;"><span>ceg+/mTmhE9XfW9N6ThEHvnoneHjuil5/7RN4XONDgB5Av68iimOTlcROmrc27TY
</span></span><span style="display:flex;"><span>UcZvDI0j7yrAwv+7Z9I9DS56vSPpqYEC0HXayyFiCn3CS2Om0ySMYdTVJRi+53kf
</span></span><span style="display:flex;"><span>8qZVEW9OMyRNIbc9djKObN4wTijMiRbZpmT2Tn0CgYAApnIBhrepxPkFhTYSMCIf
</span></span><span style="display:flex;"><span>QmQE8aovTo8qNXAEWsH14U5+dF50DxFi81nzWnWwxQ22LmCULTfwYAUfcnj1mD8B
</span></span><span style="display:flex;"><span>ztIudt4nHqCzDxHAr1Nfb4Q5T3zYqY4fXSVdT2tgWASdDsYKOEbyayIzhMrA27F+
</span></span><span style="display:flex;"><span>RMJ8gbdbBy+20cipZEFBSQKBgQCEGB2EPO43zkjvRwSg//8KyEg1p9zy3+0y1xhD
</span></span><span style="display:flex;"><span>pnTAD1R2MNHJuqIlAsPZxFfyeCRIXnnQ5BmkqhS22AKf1ziwu5cKT/tsGGEZqEEs
</span></span><span style="display:flex;"><span>0To4M9REAS/XfJmuHetP9yuxptLk4oRHEHE+j2WtdaEe/xCO+u7LR7X3rOHq2OT3
</span></span><span style="display:flex;"><span>ORw2zQKBgEACN6Qhs+ExE2+MLlC/8IaI3mPwa893LFk65/qHMuUQ2xUniJo2fQV5
</span></span><span style="display:flex;"><span>BomT4OFSDaPBftdL1a/WVg6/EvN9Re1VBncAycCsLeSB+UHnk3+MvQTCh5E3j/Vy
</span></span><span style="display:flex;"><span>gvIAt3PKqHBQTTx8p3CSxaDp91U6ru3OxetBgIchdHavxCXOkvrW
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: J5 love ST
</span></span><span style="display:flex;"><span>Encrypted Message (Base64): cG6810O8omJ67Ji6ZoQRw2um5UTx6YdTvUXWlH4GrUtph5J3xVqJhta4SWgJHNjaMgfMveJpFPTv/iAq0yBskmha+f+hRyYOITzXcz3jqtOl+4G9dC/OyqdkGIHq96lF9YZmWrXVtkCncRR07XoL+AMiBJ37HUgbHS15axAtghtJSYfWzabASA13sbEewVgQTIvg+aH9NvG5s2gKxLNIPtKcqUvmmqB2P0hFhg437QaF4SM/MBz/w7HbQT69B+YveBW8pFcgxAl+oIdl+dAneCog0FZiWI5mg13jlUmx4s7dhBKu7Ebdtayk3pZsHCKCYHNyePgSYA8bnUEqUVw+Hg==
</span></span><span style="display:flex;"><span>Decrypted Message: J5 love ST
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Public key to encrypt and decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Public Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;J5 love ST&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message (Base64):&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Public Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>MIIBCgKCAQEA1GV0AyMKyczyUpRyIolyuDRkw5hpkqhojoZ4KJvh11bqDe6H2mjJ
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>f3Io9s6lsPaN3zWxDxxJJMo5SsX48T5NQQIDAQAB
</span></span><span style="display:flex;"><span>-----END RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: J5 love ST
</span></span><span style="display:flex;"><span>node:internal/crypto/cipher:80
</span></span><span style="display:flex;"><span>    return method(data, format, type, passphrase, buffer, padding, oaepHash,
</span></span><span style="display:flex;"><span>           ^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: error:020000B3:rsa routines::missing private key
</span></span><span style="display:flex;"><span>    at Object.privateEncrypt (node:internal/crypto/cipher:80:12)
</span></span><span style="display:flex;"><span>    at signWithPrivateKey (/home/dangpham/Workspace/nodejs/demo/asymmetricLikeJWT.js:19:30)
</span></span><span style="display:flex;"><span>    at Object.&lt;anonymous&gt; (/home/dangpham/Workspace/nodejs/demo/asymmetricLikeJWT.js:56:26)
</span></span><span style="display:flex;"><span>    at Module._compile (node:internal/modules/cjs/loader:1356:14)
</span></span><span style="display:flex;"><span>    at Module._extensions..js (node:internal/modules/cjs/loader:1414:10)
</span></span><span style="display:flex;"><span>    at Module.load (node:internal/modules/cjs/loader:1197:32)
</span></span><span style="display:flex;"><span>    at Module._load (node:internal/modules/cjs/loader:1013:12)
</span></span><span style="display:flex;"><span>    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
</span></span><span style="display:flex;"><span>    at node:internal/main/run_main_module:28:49 {
</span></span><span style="display:flex;"><span>  opensslErrorStack: [ &#39;error:1C880004:Provider routines::RSA lib&#39; ],
</span></span><span style="display:flex;"><span>  library: &#39;rsa routines&#39;,
</span></span><span style="display:flex;"><span>  reason: &#39;missing private key&#39;,
</span></span><span style="display:flex;"><span>  code: &#39;ERR_OSSL_RSA_MISSING_PRIVATE_KEY&#39;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Node.js v18.19.1
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Public key to encrypt and private key to decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Public Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;J5 love ST&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message (Base64):&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Public Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>MIIBCgKCAQEAoqD5nBZ1axzJnDyxmuQmb11/3NBVZlk4py/X64ew9HH5NzrwkH04
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>t1rjt5xOTmK5N0fyrxNoouTqIpV3E85P/QIDAQAB
</span></span><span style="display:flex;"><span>-----END RSA PUBLIC KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEowIBAAKCAQEAoqD5nBZ1axzJnDyxmuQmb11/3NBVZlk4py/X64ew9HH5Nzrw
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>fKcxqqYvJv2yio3ogNZSJsFGFU1lafg7FwWMgqnd/99nWBCY2gn1
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: J5 love ST
</span></span><span style="display:flex;"><span>node:internal/crypto/cipher:80
</span></span><span style="display:flex;"><span>    return method(data, format, type, passphrase, buffer, padding, oaepHash,
</span></span><span style="display:flex;"><span>           ^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: error:020000B3:rsa routines::missing private key
</span></span><span style="display:flex;"><span>    at Object.privateEncrypt (node:internal/crypto/cipher:80:12)
</span></span><span style="display:flex;"><span>    at signWithPrivateKey (/home/dangpham/Workspace/nodejs/demo/asymmetricLikeJWT.js:19:30)
</span></span><span style="display:flex;"><span>    at Object.&lt;anonymous&gt; (/home/dangpham/Workspace/nodejs/demo/asymmetricLikeJWT.js:73:26)
</span></span><span style="display:flex;"><span>    at Module._compile (node:internal/modules/cjs/loader:1356:14)
</span></span><span style="display:flex;"><span>    at Module._extensions..js (node:internal/modules/cjs/loader:1414:10)
</span></span><span style="display:flex;"><span>    at Module.load (node:internal/modules/cjs/loader:1197:32)
</span></span><span style="display:flex;"><span>    at Module._load (node:internal/modules/cjs/loader:1013:12)
</span></span><span style="display:flex;"><span>    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
</span></span><span style="display:flex;"><span>    at node:internal/main/run_main_module:28:49 {
</span></span><span style="display:flex;"><span>  opensslErrorStack: [ &#39;error:1C880004:Provider routines::RSA lib&#39; ],
</span></span><span style="display:flex;"><span>  library: &#39;rsa routines&#39;,
</span></span><span style="display:flex;"><span>  reason: &#39;missing private key&#39;,
</span></span><span style="display:flex;"><span>  code: &#39;ERR_OSSL_RSA_MISSING_PRIVATE_KEY&#39;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Node.js v18.19.1
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Private key to encrypt and decrypt a message</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Private Key (PEM format):\n&#34;</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;J5 love ST&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encrypted Message (Base64):&#34;</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Decrypted Message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>);
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Private Key (PEM format):
</span></span><span style="display:flex;"><span> -----BEGIN RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>MIIEowIBAAKCAQEAykZk5e0pL+3la4Ydil2jc3sjJWslEvYv0qfGwi5SrKmA8HpS
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Wso3YmC9MOThDlzdM3nY4sNugECT1emFNVitiegOuOuhoD2qBvUb
</span></span><span style="display:flex;"><span>-----END RSA PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Message: J5 love ST
</span></span><span style="display:flex;"><span>Encrypted Message (Base64): dOgtEZCxxV+IoD9p8cfCgSlVNfDhgaumgihbBoD5yvhOA4r0qM2/Pq+m28riZZH66EtXUtjQoCaDt9r92flIhvnJbQeDgumCl7MwseMoZdJoDRjGGXuxEqyzinMc5mYmxayz9iSDOMt3NgDSTmClJXb+rGXkLLpM9zxpQSBrdq3wdamMrY0/JAnyul1icLZ6HpSiwSg7DhQYrZR9CDxgNeZpqyzNoUksu61EfYO7hxDcjbIZ37QrDT/Le/RBU+L6jyDyDcgETuV+xyJyVdy/C0iLtr5J72GQbcQozLrPIFZ/yYb0iePiwa72fymhIpNhMlVBgr2VFEIT/Wb9QZr7dw==
</span></span><span style="display:flex;"><span>Decrypted Message: J5 love ST
</span></span></code></pre></div>
  </div>
</details>

<h2 id="key-exchange">
  Key exchange
  <a class="anchor" href="#key-exchange">#</a>
</h2>
<ul>
<li>Algorithms: Diffie-Hellman, ECDH</li>
<li>Use cases: <a href="/docs/research/be_protocol/tls_ssl/#tls-13">SSL/TLS 1.3</a></li>
</ul>
<h3 id="diffie-hellman">
  Diffie-Hellman
  <a class="anchor" href="#diffie-hellman">#</a>
</h3>
<p><img src="/research/encription/diffie_hellman.png" alt="diffie_hellman" /></p>
<details ><summary><strong>Concept</strong></summary>
  <div class="markdown-inner">
    <img src="/research/encription/diffie_hellman_concept.png" alt="diffie_hellman_concept" />
  </div>
</details>

</br>
<details ><summary><strong>Example</strong></summary>
  <div class="markdown-inner">
    <img src="/research/encription/diffie_hellman_example.png" alt="diffie_hellman_example" />
  </div>
</details>

</br>
<details ><summary><strong>Demo code</strong></summary>
  <div class="markdown-inner">
    <p><strong>NodeJS</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// J5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createDiffieHellman</span>(<span style="color:#ae81ff">2048</span>); <span style="color:#75715e">// Prime will be 2048bit long
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">G</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getGenerator</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">P</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getPrime</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;P:&#34;</span>, <span style="color:#a6e22e">P</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;G:&#34;</span>, <span style="color:#a6e22e">G</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;------&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">generateKeys</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getPrivateKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_publicKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getPublicKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Private Key:&#34;</span>, <span style="color:#a6e22e">J5_privateKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Public Key:&#34;</span>, <span style="color:#a6e22e">J5_publicKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;------&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ST
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createDiffieHellman</span>(<span style="color:#a6e22e">P</span>, <span style="color:#a6e22e">G</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">generateKeys</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">getPrivateKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_publicKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">getPublicKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Private Key:&#34;</span>, <span style="color:#a6e22e">ST_privateKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Public Key:&#34;</span>, <span style="color:#a6e22e">ST_publicKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;------&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Exchange public keys and compute the session key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_SessionKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">computeSecret</span>(<span style="color:#a6e22e">ST_publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_SessionKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">computeSecret</span>(<span style="color:#a6e22e">J5_publicKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Session Key:&#34;</span>, <span style="color:#a6e22e">J5_SessionKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Session Key:&#34;</span>, <span style="color:#a6e22e">ST_SessionKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>P: b811e65181d3cc8942efa49832bc09fc4f608ea03d9ccf70a082509b4f31024665ad50e8915a2146b3da8a59d0c1fd32b26dc410f29e9ef265956b6f060b9d70f9be4c2c2b1e4b87391da617962a096a3995be117aa64196d198aa1d4e28769130f7d79bb4ea5c9a21dcce9d6e5b542de3478e860ab304ce97d162334040bb7c24e5d1edfac7bd9223cd848394f001c45078282145a3c32aa127a9e917ac5d896e153800832daa56765cf33f004ee256f23011633ac260bf8a560a131d8f3e39c9692e58fc788ce58a68db7cbb3d2faec198604b4854ade3fd6847480c93a5cae3143ac12632f75aa19dc33cbf8724c421e59fd756706d7c05fe970bb849bc2f
</span></span><span style="display:flex;"><span>G: 02
</span></span><span style="display:flex;"><span>------
</span></span><span style="display:flex;"><span>J5 Private Key: 5b39e6ae9b1edb2907b32bd4be76226b19d7f1b45637a6551fcd83f9ce374bd802ab050c9ddcae9d4a895a9c6d604e285ef18148e2f0952cb250047167052dd026f8229cbce07a1a8eb8aa0917a45ca6af7a43efd793816fcbb2e3bbd37e0afccd787cc0604f511d191e365a8bcd7353484e64b602ac198d22237f2803ab0d70da71d9567044bddc36a41c9d674832af9a0c9e0e058e5be336158b0d7636641171ffce5df77ad1c5f9dc732aec932af1625def4ac267735caff756edbb764f0870055b3f2ab754009080558b3f84643072dd289507dc30b2135934d3d11ab7657ad85971d550615c4bd8b690232e787232ffe58550a08d2cc71ae7f6ecdec593
</span></span><span style="display:flex;"><span>J5 Public Key: 5b7843a2d16ecf3065db80bdc82e104eeab48d04a0fe1364cba37b865698cb9166e28eac4d0d7e2ed1ef3f23dbabbdc326b4ce6bbf998da1892ee9632ada41a07209e3c8896df1e27c336601d2be777e168110f6b4e3ddcd5096dd12ed3db535a6b8616ed55646d5f42cb5b8788b693e1e7706ff40ba70de6f1293a63f03aa0520e1857a51e6f44dfbefdeb8daa61b33621a543e4d7242142e51aac08484a9c93e311daaab86f51bfa34660076a57a8169175db79982bf779246d2040c37cfc4e66bfce3bad8e2cef138c57e9f9939fc6f088cd62de0944d1f73d2653778bbe665ea8ce15d06a22dce2387c274d641331562018d2a37281db03335a3789688f8
</span></span><span style="display:flex;"><span>------
</span></span><span style="display:flex;"><span>ST Private Key: 46d4b3e40b0a45f9bfab045faff7fb157dce4dc5c71caf4411df231428e83f3b0139f9fb4d2e9bd878a2b0a83a145abf463a32ae37caaea0b679a369b7a4567e3b1e42a57af016e47d6540a9802f2771fdf53c9f8506b637854bf483da590ded287fb43b4f3edfc8801aa32f358b76b89a83dfd192154bc45291caf31244f6c7fe8eee8e44091564bd2b1c82faa3a2bd8c79db56ccb140c84ef92fc4ce6a8647eaaeeda3eaa6720c96e696c982cd76d51fe404280ee7096db53ff01087699b9f2ab816b0c61f9725afde4afe9a270fb87d208b3b927913c1f11be002b7589008c892790deddb67f4c63aab04bcb00dc7c8bba4dec5fe4f966e2c1a332d35faef
</span></span><span style="display:flex;"><span>ST Public Key: 78bbdc4d210d5784bab05bdc68e3c170f77f7adcede7a0c205df4e5416fddd0482717e5020d7f871bd8c04b8e851e0c5da72af96dd124259b759a6ebecbc230e44dfc3eeeef02221ebc7bab20704d1935480bb03605bfcfac31c5e66803771cfabbe029e28620de3f0f4637de4ad5871227d451710b33d9d8eae801e3657d5ee864c6e96951bfadee6e398b71ceda31e61e24685c765b9a63d16bd75cbac34e4093c6f7ba833f447abd5b4778fba145ab5b18e02ad2cc70bc217f85d568ba3445bc9f2a83d446047cb11f2f902078d2dd71250f5443bd634c286334916e1d4d99294a73af6fffa8fb722b39b7a4ca00cf7205663bb61d8f0314ed110ed619fab
</span></span><span style="display:flex;"><span>------
</span></span><span style="display:flex;"><span>J5 Session Key: 1e30adb4b9488cbdae04e5c4bb01228ef3f9dcda83f643243ab13199bef55d6e0a828d54f01bd2f8192f89eaca6f221749e172bdd81a0e16c38d1f7775cc2ab4c673a1ac3a05cd39511e5e1ee03a1c741453cfd599f8a49a3ddb8011decc1edaaccda5d276ab4950de6b1e04ff0d770f5d6624a1b3ec6d564a0e1fd4440c08f68c07c633299ae575531117d56e7385f402238c78440dbbd37cf78b70c66a9de5087f911e76056f8f88ab29bb44448b092757e9d3a4224748383584fd5022c070766423a65957eeeff55cba16f991b445d3c93d6b03f2808df199e5d43ac87b4573f641ca0a978695392975f0d6b4d2c035e34bf2ab3c8b1b184bce645fd53eb3
</span></span><span style="display:flex;"><span>ST Session Key: 1e30adb4b9488cbdae04e5c4bb01228ef3f9dcda83f643243ab13199bef55d6e0a828d54f01bd2f8192f89eaca6f221749e172bdd81a0e16c38d1f7775cc2ab4c673a1ac3a05cd39511e5e1ee03a1c741453cfd599f8a49a3ddb8011decc1edaaccda5d276ab4950de6b1e04ff0d770f5d6624a1b3ec6d564a0e1fd4440c08f68c07c633299ae575531117d56e7385f402238c78440dbbd37cf78b70c66a9de5087f911e76056f8f88ab29bb44448b092757e9d3a4224748383584fd5022c070766423a65957eeeff55cba16f991b445d3c93d6b03f2808df199e5d43ac87b4573f641ca0a978695392975f0d6b4d2c035e34bf2ab3c8b1b184bce645fd53eb3
</span></span></code></pre></div>
  </div>
</details>

<h3 id="elliptic-curve-diffie-hellman-ecdh">
  Elliptic-curve Diffie-Hellman (ECDH)
  <a class="anchor" href="#elliptic-curve-diffie-hellman-ecdh">#</a>
</h3>
<p><img src="/research/encription/ecdh.png" alt="ecdh" /></p>
<details ><summary><strong>Demo code</strong></summary>
  <div class="markdown-inner">
    <p><strong>NodeJS</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// J5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createECDH</span>(<span style="color:#e6db74">&#39;secp256k1&#39;</span>); <span style="color:#75715e">// Use secp256k1 curve
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">generateKeys</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getPrivateKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_publicKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">getPublicKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Private Key:&#34;</span>, <span style="color:#a6e22e">J5_privateKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Public Key:&#34;</span>, <span style="color:#a6e22e">J5_publicKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;------&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ST
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createECDH</span>(<span style="color:#e6db74">&#39;secp256k1&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">generateKeys</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">getPrivateKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_publicKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">getPublicKey</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Private Key:&#34;</span>, <span style="color:#a6e22e">ST_privateKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Public Key:&#34;</span>, <span style="color:#a6e22e">ST_publicKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#34;hex&#34;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;------&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Exchange public keys and compute the session key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">J5_SessionKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">J5</span>.<span style="color:#a6e22e">computeSecret</span>(<span style="color:#a6e22e">ST_publicKey</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ST_SessionKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ST</span>.<span style="color:#a6e22e">computeSecret</span>(<span style="color:#a6e22e">J5_publicKey</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;J5 Session Key:&#34;</span>, <span style="color:#a6e22e">J5_SessionKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;ST Session Key:&#34;</span>, <span style="color:#a6e22e">ST_SessionKey</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>J5 Private Key: b63f1be5cbccc1a2600e00e1df88b9ad5da603e05cc04c6e0c36185c01ed76f1
</span></span><span style="display:flex;"><span>J5 Public Key: 04b814f0659792bb510b682bdd1a00ab729abaa2ad177a04453670ae79f7de5342931c773eed012195a1ff0e9fb60eef13310b0938e472d5b51bdb7659a961a4db
</span></span><span style="display:flex;"><span>------
</span></span><span style="display:flex;"><span>ST Private Key: 5749d6da1161b582a463a49759627bcb1dcd2d77592d7509bedb86abe046e62a
</span></span><span style="display:flex;"><span>ST Public Key: 046c8f16a93320a034926af4f62300d138686e80d90b25de30c87550d4483e4245440142c4ff386d48fadc46b7ebe280b767bd49c6daf643dc50ae3c941c5655db
</span></span><span style="display:flex;"><span>------
</span></span><span style="display:flex;"><span>J5 Session Key: 157d9a740b720f62bd057888d02e806f5f50cebf9e0ffab831243d71152def41
</span></span><span style="display:flex;"><span>ST Session Key: 157d9a740b720f62bd057888d02e806f5f50cebf9e0ffab831243d71152def41
</span></span></code></pre></div>
  </div>
</details>

<h2 id="digital-signatures">
  Digital signatures
  <a class="anchor" href="#digital-signatures">#</a>
</h2>
<ul>
<li>Prove message <strong>authenticity</strong> and <strong>integrity</strong></li>
<li>Non-repudiation</li>
<li>Use asymmetric encryption</li>
</ul>
<h3 id="how">
  How
  <a class="anchor" href="#how">#</a>
</h3>
<ul>
<li>The message is signed by the private key</li>
<li>The signature is verified by the corresponding public key</li>
</ul>
<p><img src="/research/encription/digital_signature.png" alt="digital_signature" /></p>
<h3 id="use-cases">
  Use cases
  <a class="anchor" href="#use-cases">#</a>
</h3>
<ul>
<li>Sign contracts</li>
<li>Sign and approve payments in the <strong>bank systems</strong></li>
<li>Signed transactions allow users to transfer a <strong>blockchain</strong> asset from one address to another</li>
</ul>
<h3 id="demo-1">
  Demo
  <a class="anchor" href="#demo-1">#</a>
</h3>
<blockquote class="book-hint info">
  This demo can be run directly in the console of the Chrome browser
</blockquote>

<p><strong>Javascript</strong></p>
<details ><summary>Prepare</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">generateKeyPair</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keyPair</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">generateKey</span>(
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RSASSA-PKCS1-v1_5&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">modulusLength</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2048</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">publicExponent</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">hash</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SHA-256&#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">&#34;sign&#34;</span>, <span style="color:#e6db74">&#34;verify&#34;</span>]
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">keyPair</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signMessage</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">privateKey</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encodedMessage</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextEncoder</span>().<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signature</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">sign</span>(
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RSASSA-PKCS1-v1_5&#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">privateKey</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">encodedMessage</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">arrayBufferToHex</span>(<span style="color:#a6e22e">signature</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">verifySignature</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">hexSignature</span>, <span style="color:#a6e22e">publicKey</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encodedMessage</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextEncoder</span>().<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signatureBuffer</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hexToArrayBuffer</span>(<span style="color:#a6e22e">hexSignature</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">subtle</span>.<span style="color:#a6e22e">verify</span>(
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RSASSA-PKCS1-v1_5&#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">publicKey</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">signatureBuffer</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">encodedMessage</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">arrayBufferToHex</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">buffer</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Array.<span style="color:#a6e22e">from</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">buffer</span>))
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>((<span style="color:#66d9ef">byte</span>) =&gt; <span style="color:#66d9ef">byte</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">16</span>).<span style="color:#a6e22e">padStart</span>(<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;0&#39;</span>))
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;&#39;</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hexToArrayBuffer</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">hex</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">typedArray</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">hex</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/[\da-f]{2}/gi</span>).<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">h</span>) =&gt; parseInt(<span style="color:#a6e22e">h</span>, <span style="color:#ae81ff">16</span>)));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">typedArray</span>.<span style="color:#a6e22e">buffer</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Main flow</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>(<span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">publicKey</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;I&lt;3U&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ST-Sender signs the message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signatureHex</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">signMessage</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">privateKey</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Signature (Hex):&#34;</span>, <span style="color:#a6e22e">signatureHex</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// HT-Hacker modifies the original message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;I hate you&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Rose-Receiver verifies the signature
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isValid</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">verifySignature</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">signatureHex</span>, <span style="color:#a6e22e">publicKey</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Is the signature valid?&#34;</span>, <span style="color:#a6e22e">isValid</span>);
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div>
  </div>
</details>

</br>
<details ><summary>Output</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&gt; Message: I&lt;3U
</span></span><span style="display:flex;"><span>&gt; Signature (Hex): 02195d3ee8155a2581f7bf3f784347f2dfbbf352113c5a4489721a7dc5f6b2b2304d3dba1a83f596cd8420e8b8b2beb3bc0e6872d83eb4d430382603c2fb75f875698d19d1212b926c79ee2b8ef08b03a6715bb0eb7d518b7b773d28805aef533836a6f906034fa602958ce769ffa436d8223ba6bf5c144f596ffa64ce0bbaa917157b54d58a0c50c877c7a38583bdcd6ed3d55d2d9d5fd3d8227d387a9b42e3c6d20b7b24d4febf32d771557ed87863cab19db293da28100a7ee2eaba706156f93dba44c20c39c73ef1ae51cdbf511acf063441040d6917fbc68a077ec1a17dfa68cc2208ffb6b06085674fcbe316dfe7102b07ac8dca029ec2e17d4a8ec173
</span></span><span style="display:flex;"><span>&gt; Message: I hate you
</span></span><span style="display:flex;"><span>&gt; Is the signature valid? false
</span></span></code></pre></div>
  </div>
</details>

<h2 id="appendix">
  Appendix
  <a class="anchor" href="#appendix">#</a>
</h2>
<h3 id="bcrypt-vs-md5">
  Bcrypt vs MD5
  <a class="anchor" href="#bcrypt-vs-md5">#</a>
</h3>
<ul>
<li>Cracking password time</li>
</ul>
<h4 id="bcrypt">
  Bcrypt
  <a class="anchor" href="#bcrypt">#</a>
</h4>
<p><img src="/research/encription/2024_Password_Table_bcrypt.png" alt="2024_Password_Table_bcrypt" /></p>
<h4 id="md5">
  MD5
  <a class="anchor" href="#md5">#</a>
</h4>
<p><img src="/research/encription/2024_Password_Table_MD5.png" alt="2024_Password_Table_MD5" /></p>
<h3 id="compare-speed">
  Compare speed
  <a class="anchor" href="#compare-speed">#</a>
</h3>
<ul>
<li>Maximun byte RSA-4096-PKCS1 can encrypt: 470 bytes</li>
</ul>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Encrypt</th>
          <th>Decrypt</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>SHA512</td>
          <td>0.34 ms</td>
          <td>N/A</td>
      </tr>
      <tr>
          <td>AES-256-GCM</td>
          <td>0.43 ms</td>
          <td>0.14 ms</td>
      </tr>
      <tr>
          <td>RSA-4096-PKCS1-encrypt</td>
          <td>0.30 ms</td>
          <td>2.83 ms</td>
      </tr>
      <tr>
          <td>RSA-4096-PKCS1-sign</td>
          <td>2.66 ms</td>
          <td>0.16 ms</td>
      </tr>
  </tbody>
</table>
<details ><summary>NodeJS</summary>
  <div class="markdown-inner">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">crypto</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;crypto&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">performance</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;perf_hooks&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">func</span>, ...<span style="color:#a6e22e">args</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">startTime</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">performance</span>.<span style="color:#a6e22e">now</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">func</span>(...<span style="color:#a6e22e">args</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">endTime</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">performance</span>.<span style="color:#a6e22e">now</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">func</span>.<span style="color:#a6e22e">name</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> execution time:`</span>, (<span style="color:#a6e22e">endTime</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">startTime</span>).<span style="color:#a6e22e">toFixed</span>(<span style="color:#ae81ff">2</span>), <span style="color:#e6db74">&#39;ms&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">hashSHA512</span>(<span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hash</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createHash</span>(<span style="color:#e6db74">&#39;sha512&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">hash</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">generateKeyAndIV</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">randomBytes</span>(<span style="color:#ae81ff">32</span>); <span style="color:#75715e">// 256-bit key (32 bytes, the longest allowed by AES)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">randomBytes</span>(<span style="color:#ae81ff">12</span>); <span style="color:#75715e">// 96-bit IV (12 bytes, recommended for GCM)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encryptAESGCM</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>, <span style="color:#a6e22e">plaintext</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cipher</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createCipheriv</span>(<span style="color:#e6db74">&#39;aes-256-gcm&#39;</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedAES</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">concat</span>([<span style="color:#a6e22e">cipher</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">plaintext</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>), <span style="color:#a6e22e">cipher</span>.<span style="color:#66d9ef">final</span>()]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">authTag</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cipher</span>.<span style="color:#a6e22e">getAuthTag</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">encryptedAES</span>, <span style="color:#a6e22e">authTag</span> };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptAESGCM</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>, <span style="color:#a6e22e">encrypted</span>, <span style="color:#a6e22e">authTag</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decipher</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createDecipheriv</span>(<span style="color:#e6db74">&#39;aes-256-gcm&#39;</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decipher</span>.<span style="color:#a6e22e">setAuthTag</span>(<span style="color:#a6e22e">authTag</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">concat</span>([<span style="color:#a6e22e">decipher</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">encrypted</span>), <span style="color:#a6e22e">decipher</span>.<span style="color:#66d9ef">final</span>()]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">generateKeyPair</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">generateKeyPairSync</span>(<span style="color:#e6db74">&#39;rsa&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">modulusLength</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">4096</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">publicKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Public Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">privateKeyEncoding</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pkcs1&#39;</span>, <span style="color:#75715e">// Private Key Cryptography Standards 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pem&#39;</span>  <span style="color:#75715e">// Output as PEM (Base64 encoded)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encryptWithPublicKey</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">publicEncrypt</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">encrypted</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptWithPrivateKey</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">privateDecrypt</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">signWithPrivateKey</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">message</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">privateEncrypt</span>(<span style="color:#a6e22e">privateKeyPem</span>, <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">message</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">encrypted</span>; 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">verifyWithPublicKey</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">publicDecrypt</span>(<span style="color:#a6e22e">publicKeyPem</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>; 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">generateDummyText</span>(<span style="color:#a6e22e">byteLength</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">characters</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">charactersLength</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">characters</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">currentLength</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">currentLength</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">byteLength</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">characters</span>.<span style="color:#a6e22e">charAt</span>(Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#a6e22e">charactersLength</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">result</span> <span style="color:#f92672">+=</span> <span style="color:#66d9ef">char</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">currentLength</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">byteLength</span>(<span style="color:#a6e22e">result</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">currentLength</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">byteLength</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateDummyText</span>(<span style="color:#ae81ff">470</span>); <span style="color:#75715e">// Maximun byte RSA-4096-PKCS1 can encrypt
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Original Message:&#34;</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyPair</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">generateKeyAndIV</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hash</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">hashSHA512</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">encryptedAES</span>, <span style="color:#a6e22e">authTag</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">encryptAESGCM</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>, <span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedAES</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">decryptAESGCM</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">iv</span>, <span style="color:#a6e22e">encryptedAES</span>, <span style="color:#a6e22e">authTag</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">encryptWithPublicKey</span>, <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">decryptWithPrivateKey</span>, <span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">encryptedMessage</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">signWithPrivateKey</span>, <span style="color:#a6e22e">privateKey</span>, <span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">verifiedMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">measurePerformance</span>(<span style="color:#a6e22e">verifyWithPublicKey</span>, <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">signedMessage</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;SHA-512 hashed message:&#34;</span>, <span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">digest</span>(<span style="color:#e6db74">&#39;hex&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;AES decrypted message:&#34;</span>, <span style="color:#a6e22e">decryptedAES</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;RSA decrypted message:&#34;</span>, <span style="color:#a6e22e">decryptedMessage</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;RSA verified message:&#34;</span>, <span style="color:#a6e22e">verifiedMessage</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>));
</span></span></code></pre></div>
  </div>
</details>

<h2 id="reference">
  Reference
  <a class="anchor" href="#reference">#</a>
</h2>
<ul>
<li>Cryptobook: <a href="https://cryptobook.nakov.com/cryptography-overview">Cryptography - Overview</a> (Jun 19th, 2019)</li>
<li>Jscape: <a href="https://www.jscape.com/blog/understanding-hashing">Understanding Hashing</a> (May 18th, 2024)</li>
<li>IBM: <a href="https://www.ibm.com/docs/en/i/7.4?topic=sf-hash-md5-hash-sha1-hash-sha256-hash-sha512">HASH_MD5, HASH_SHA1, HASH_SHA256, and HASH_SHA512</a> (Apr 11th, 2023)</li>
<li>Dalhousie University: <a href="https://www.mscs.dal.ca/~selinger/md5collision/">MD5 Collision Demo</a> (Oct 11th, 2011)</li>
<li>Hackernoon: <a href="https://hackernoon.com/hmac-and-message-authentication-codes-why-using-hashing-alone-is-not-enough-for-data-integrity">HMAC &amp; Message Authentication Codes</a> (Aug 15th, 2023)</li>
<li>Linkedin: <a href="https://www.linkedin.com/advice/3/what-some-common-use-cases-best-practices-hmac-web-applications">What are some common use cases and best practices for HMAC in web applications?</a></li>
<li>Jscape: <a href="https://www.jscape.com/blog/what-is-hmac-and-how-does-it-secure-file-transfers">What Is HMAC, And How Does It Secure File Transfers?</a> (May 18th, 2024)</li>
<li>Digicert: <a href="https://dev.digicert.com/en/trustcore-sdk/nanocrypto/asymmetric-algorithms.html">Asymmetric algorithms</a></li>
<li>Geeksforgeeks: <a href="https://www.geeksforgeeks.org/node-js-crypto-createecdh-method/">Node.js crypto.createECDH() Method</a> (Oct 11th, 2021)</li>
<li>Jscape: <a href="https://www.jscape.com/blog/what-is-a-digital-signature">What is a Digital Signature?</a> (Dec 11th, 2022)</li>
<li>Hivesystems: <a href="https://www.hivesystems.com/blog/are-your-passwords-in-the-green">Are Your Passwords in the Green?</a> (2024)</li>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Key_size">Key size</a> (Sep 18th, 2024)</li>
<li>Townsend Security: <a href="https://info.townsendsecurity.com/bid/29195/how-much-data-can-you-encrypt-with-rsa-keys">How Much Data Can You Encrypt with RSA Keys?</a> (Apr 1st, 2011)</li>
<li>DangPham112000: <a href="https://github.com/DangPham112000/blog-demo">Examples code</a> (2024)</li>
</ul>
<style>
    .feedback-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        max-width: 100%;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        background-color: #f9f9fb;
    }
    .feedback-card h2 {
        font-size: 20px;
        margin-top: 0px;
        margin-bottom: 10px;
    }
    .feedback-card .buttons {
        margin: 10px 0;
    }
    .feedback-card button {
        border: none;
        background-color: #f0f0f0;
        border-radius: 4px;
        padding: 10px 15px;
        margin-right: 10px;
        cursor: pointer;
        font-size: 16px;
    }
    .feedback-card button:hover {
        background-color: #e0e0e0;
    }
    .feedback-card a {
        color: #0074d9;
        text-decoration: none;
    }
    .feedback-card a:hover {
        text-decoration: underline;
    }
    .feedback-card p {
        font-size: 14px;
        color: #555;
    }

     
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 7px;
      padding-bottom: 50px;

      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: flex-end;
    }

    .modal-content {
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      width: 300px;
    }

    .modal input {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
    }
</style>
<div class="feedback-card" id="feedbackCard">
    <h2>Help improve my blog</h2>
    <p>Was this page helpful to you?</p>
    <div class="buttons">
        <button id="yesBtn">👍 Yes</button>
        <button id="noBtn">👎 No</button>
    </div>
    <p>This page was last modified at <strong>2024-11-15</strong></p>
    <ul>
        <li><a href="https://github.com/DangPham112000/blog" target="_blank">View this page on GitHub</a></li>
        <li><a href="#" class="link-button" id="linkButton">Report a problem with this content</a></li>
    </ul>
</div>

<div class="modal" id="formModal">
    <div class="feedback-card">
        <h2>Can I know your name?</h2>
        <form id="form">
            <input type="text" name="username" placeholder="Enter your name">
            <button type="submit">Yes</button>
            <button type="submit">No</button>
        </form>
    </div>
</div>

<script>
    const feedbackCardEle = document.getElementById("feedbackCard");
    const formModalEle = document.getElementById('formModal');
    const elesToShowForm = ['linkButton', 'yesBtn', 'noBtn'];

    for (const ele of elesToShowForm) {
        document.getElementById(ele).addEventListener('click', function(e) {
            e.preventDefault();
            formModalEle.style.display = 'flex';
        });
    }

    window.onclick = function(event) {
        if (event.target === formModalEle) {
            formModalEle.style.display = 'none';
        }
    };

    document.getElementById('form').addEventListener('submit', function(e) {
        e.preventDefault(); 
        alert('This feature is currently being developed');
        formModalEle.style.display = 'none'; 
    });
</script>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#hash">Hash</a>
      <ul>
        <li><a href="#good-hash-function">Good hash function</a></li>
        <li><a href="#use-case">Use case</a></li>
        <li><a href="#collision">Collision</a></li>
      </ul>
    </li>
    <li><a href="#symmetric-encryption">Symmetric encryption</a>
      <ul>
        <li><a href="#use-case-1">Use case</a></li>
        <li><a href="#demo-code">Demo code</a></li>
      </ul>
    </li>
    <li><a href="#hmac">HMAC</a>
      <ul>
        <li><a href="#why-and-how">Why and how</a></li>
        <li><a href="#use-case-2">Use case</a></li>
        <li><a href="#demo">Demo</a></li>
      </ul>
    </li>
    <li><a href="#asymmetric-encryption">Asymmetric encryption</a>
      <ul>
        <li><a href="#public-encryption--private-decryption">Public encryption / private decryption</a></li>
        <li><a href="#private-sign-encryption--public-verify-decryption">Private sign (encryption) / public verify (decryption)</a></li>
      </ul>
    </li>
    <li><a href="#key-exchange">Key exchange</a>
      <ul>
        <li><a href="#diffie-hellman">Diffie-Hellman</a></li>
        <li><a href="#elliptic-curve-diffie-hellman-ecdh">Elliptic-curve Diffie-Hellman (ECDH)</a></li>
      </ul>
    </li>
    <li><a href="#digital-signatures">Digital signatures</a>
      <ul>
        <li><a href="#how">How</a></li>
        <li><a href="#use-cases">Use cases</a></li>
        <li><a href="#demo-1">Demo</a></li>
      </ul>
    </li>
    <li><a href="#appendix">Appendix</a>
      <ul>
        <li><a href="#bcrypt-vs-md5">Bcrypt vs MD5</a></li>
        <li><a href="#compare-speed">Compare speed</a></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












